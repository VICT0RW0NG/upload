<html>
    <head>
    <title></title>
    <script type="text/javascript">

		function getSearchParameters() {
		      var prmstr = window.location.search.substr(1);
		      return prmstr != null && prmstr != "" ? transformToAssocArray(prmstr) : {};
		}
		
		function transformToAssocArray( prmstr ) {
		    var params = {};
		    var prmarr = prmstr.split("&");
		    for ( var i = 0; i < prmarr.length; i++) {
		        var tmparr = prmarr[i].split("=");
		        params[tmparr[0]] = tmparr[1];
		    }
		    return params;
		}
		
		
		 function getDiffResult() {
			var req = new XMLHttpRequest();
			req.open('GET', document.location, false);
			req.send(null);
			
			// associate array to store all values
			var data = new Object();
			
			// get all headers in one call and parse each item
			var headers = req.getAllResponseHeaders().toLowerCase();
			var aHeaders = headers.split('\n');
			var i =0;
			for (i= 0; i < aHeaders.length; i++) {
			    var thisItem = aHeaders[i];
			    var key = thisItem.substring(0, thisItem.indexOf(':'));
			    var value = thisItem.substring(thisItem.indexOf(':')+1);
			    data[key] = value;
			}	    
			
			var diffResult = navigator.diffResult;
			return diffResult;
		}	
		
		
		document.addEventListener("DOMContentLoaded", function(event) { 
			//var params = getSearchParameters();
			
			//var diff = Date.now() - params.time
			
			var diff = Date.now() - getDiffResult()
			
			if(diff != NaN)
				document.getElementById("diffResult").innerHTML = "Elapsed Time:" + diff + "ms"
			
		});
				
		function submitForm(form)
		{
			document.getElementById("submitTime").value = Date.now();
			document.getElementById("uploadForm").submit();

		}
    </script>
    </head>
    <body>
        <form id="uploadForm" action="/upload" enctype="multipart/form-data" method="post">
            File: <input type="file" name="file"><br><br>
			<input name="submitTime" id="submitTime" type="hidden" />
            <input type="button" value="upload" onclick="submitForm()">
            
            <div id="diffResult" ></div>
        </form>
    </body>
</html>